<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Sat Nov 01 16:02:15 EDT 2014 -->
<title>BPlusTreeFile</title>
<meta name="date" content="2014-11-01">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BPlusTreeFile";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="BPlusTreeFile.html#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="BPlusTreeEntry.html" title="class in simpledb"><span class="strong">Prev Class</span></a></li>
<li><a href="BPlusTreeFileEncoder.html" title="class in simpledb"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html@simpledb%252FBPlusTreeFile.html" target="_top">Frames</a></li>
<li><a href="BPlusTreeFile.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="BPlusTreeFile.html#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">simpledb</div>
<h2 title="Class BPlusTreeFile" class="title">Class BPlusTreeFile</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>simpledb.BPlusTreeFile</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="DbFile.html" title="interface in simpledb">DbFile</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">BPlusTreeFile</span>
extends java.lang.Object
implements <a href="DbFile.html" title="interface in simpledb">DbFile</a></pre>
<div class="block">BPlusTreeFile is an implementation of a DbFile that stores a B+ tree.
 Specifically, it stores a pointer to a root page,
 a set of internal pages, and a set of leaf pages, which contain a collection of tuples
 in sorted order. BPlusTreeFile works closely with BPlusTreeLeafPage, BPlusTreeInternalPage,
 and BPlusTreeRootPtrPage. The format of these pages is described in their constructors.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Becca Taft</dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="BPlusTreeLeafPage.html#BPlusTreeLeafPage(simpledb.BPlusTreePageId, byte[], int)"><code>BPlusTreeLeafPage.BPlusTreeLeafPage(simpledb.BPlusTreePageId, byte[], int)</code></a>, 
<a href="BPlusTreeInternalPage.html#BPlusTreeInternalPage(simpledb.BPlusTreePageId, byte[], int)"><code>BPlusTreeInternalPage.BPlusTreeInternalPage(simpledb.BPlusTreePageId, byte[], int)</code></a>, 
<a href="BPlusTreeRootPtrPage.html#BPlusTreeRootPtrPage(simpledb.BPlusTreePageId, byte[])"><code>BPlusTreeRootPtrPage.BPlusTreeRootPtrPage(simpledb.BPlusTreePageId, byte[])</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.io.File</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#f">f</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#keyField">keyField</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#tableid">tableid</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="TupleDesc.html" title="class in simpledb">TupleDesc</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#td">td</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="BPlusTreeFile.html#BPlusTreeFile(java.io.File, int, simpledb.TupleDesc)">BPlusTreeFile</a></strong>(java.io.File&nbsp;f,
             int&nbsp;key,
             <a href="TupleDesc.html" title="class in simpledb">TupleDesc</a>&nbsp;td)</code>
<div class="block">Constructs a B+ tree file backed by the specified file.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.ArrayList&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#deleteTuple(simpledb.TransactionId, simpledb.Tuple)">deleteTuple</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
           <a href="Tuple.html" title="class in simpledb">Tuple</a>&nbsp;t)</code>
<div class="block">Delete a tuple from this BPlusTreeFile.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#findLeafPage(simpledb.TransactionId, simpledb.Field, simpledb.BPlusTreePageId, simpledb.Permissions)">findLeafPage</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
            <a href="Field.html" title="interface in simpledb">Field</a>&nbsp;f,
            <a href="BPlusTreePageId.html" title="class in simpledb">BPlusTreePageId</a>&nbsp;pid,
            <a href="Permissions.html" title="class in simpledb">Permissions</a>&nbsp;perm)</code>
<div class="block">Recursive function which finds and locks the leaf page in the B+ tree corresponding to
 the left-most page possibly containing the key field f.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#getEmptyPage(simpledb.TransactionId, java.util.HashSet)">getEmptyPage</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
            java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Get the page number of the first empty page in this BPlusTreeFile.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.io.File</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#getFile()">getFile</a></strong>()</code>
<div class="block">Returns the File backing this BPlusTreeFile on disk.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#getId()">getId</a></strong>()</code>
<div class="block">Returns an ID uniquely identifying this BPlusTreeFile.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="BPlusTreeRootPtrPage.html" title="class in simpledb">BPlusTreeRootPtrPage</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#getRootPtrPage(simpledb.TransactionId)">getRootPtrPage</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid)</code>
<div class="block">Get a read lock on the root pointer page.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="TupleDesc.html" title="class in simpledb">TupleDesc</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#getTupleDesc()">getTupleDesc</a></strong>()</code>
<div class="block">Returns the TupleDesc of the table stored in this DbFile.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#handleMinOccupancyInternalPage(simpledb.TransactionId, simpledb.BPlusTreeInternalPage, java.util.HashSet)">handleMinOccupancyInternalPage</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                              <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;page,
                              java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Handle the case when an internal page becomes less than half full due to deletions.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#handleMinOccupancyLeafPage(simpledb.TransactionId, simpledb.BPlusTreeLeafPage, java.util.HashSet)">handleMinOccupancyLeafPage</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                          <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;page,
                          java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Handle the case when a leaf page becomes less than half full due to deletions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="DbFileIterator.html" title="interface in simpledb">DbFileIterator</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#indexIterator(simpledb.TransactionId, simpledb.IndexPredicate)">indexIterator</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
             <a href="IndexPredicate.html" title="class in simpledb">IndexPredicate</a>&nbsp;ipred)</code>
<div class="block">get the specified tuples from the file based on its IndexPredicate value on
 behalf of the specified transaction.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.ArrayList&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#insertTuple(simpledb.TransactionId, simpledb.Tuple)">insertTuple</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
           <a href="Tuple.html" title="class in simpledb">Tuple</a>&nbsp;t)</code>
<div class="block">Insert a tuple into this BPlusTreeFile, keeping the tuples in sorted order.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="DbFileIterator.html" title="interface in simpledb">DbFileIterator</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#iterator(simpledb.TransactionId)">iterator</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid)</code>
<div class="block">Get an iterator for all tuples in this B+ tree file in sorted order.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#keyField()">keyField</a></strong>()</code>
<div class="block">Returns the index of the field that this B+ tree is keyed on</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#mergeInternalPages(simpledb.TransactionId, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeEntry, java.util.HashSet)">mergeInternalPages</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                  <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;leftPage,
                  <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;rightPage,
                  <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;parent,
                  <a href="BPlusTreeEntry.html" title="class in simpledb">BPlusTreeEntry</a>&nbsp;parentEntry,
                  java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Merge two internal pages by moving all entries from the right page to the left page.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#mergeLeafPages(simpledb.TransactionId, simpledb.BPlusTreeLeafPage, simpledb.BPlusTreeLeafPage, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeEntry, java.util.HashSet)">mergeLeafPages</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
              <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;leftPage,
              <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;rightPage,
              <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;parent,
              <a href="BPlusTreeEntry.html" title="class in simpledb">BPlusTreeEntry</a>&nbsp;parentEntry,
              java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Merge two leaf pages by moving all tuples from the right page to the left page.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#numPages()">numPages</a></strong>()</code>
<div class="block">Returns the number of pages in this BPlusTreeFile.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="Page.html" title="interface in simpledb">Page</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#readPage(simpledb.PageId)">readPage</a></strong>(<a href="PageId.html" title="interface in simpledb">PageId</a>&nbsp;pid)</code>
<div class="block">Read a page from the file on disk.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#setEmptyPage(simpledb.TransactionId, java.util.HashSet, int)">setEmptyPage</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
            java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages,
            int&nbsp;emptyPageNo)</code>
<div class="block">Mark a page in this BPlusTreeFile as empty.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#splitInternalPage(simpledb.BPlusTreeInternalPage, simpledb.TransactionId, java.util.HashSet, simpledb.Field)">splitInternalPage</a></strong>(<a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;page,
                 <a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                 java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages,
                 <a href="Field.html" title="interface in simpledb">Field</a>&nbsp;field)</code>
<div class="block">Recursively split internal pages as needed to make room for new entries.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a></code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#splitLeafPage(simpledb.BPlusTreeLeafPage, simpledb.TransactionId, java.util.HashSet, simpledb.Field)">splitLeafPage</a></strong>(<a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;page,
             <a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
             java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages,
             <a href="Field.html" title="interface in simpledb">Field</a>&nbsp;field)</code>
<div class="block">Split a leaf page to make room for new tuples and recursively split the parent node
 as needed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#updateParentPointer(simpledb.TransactionId, simpledb.BPlusTreePageId, simpledb.BPlusTreePageId, java.util.HashSet)">updateParentPointer</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                   <a href="BPlusTreePageId.html" title="class in simpledb">BPlusTreePageId</a>&nbsp;pid,
                   <a href="BPlusTreePageId.html" title="class in simpledb">BPlusTreePageId</a>&nbsp;child,
                   java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Helper function to update the parent pointer of a node.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#updateParentPointers(simpledb.TransactionId, simpledb.BPlusTreeInternalPage, java.util.HashSet)">updateParentPointers</a></strong>(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                    <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;page,
                    java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)</code>
<div class="block">Update the parent pointer of every child of the given page</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="BPlusTreeFile.html#writePage(simpledb.Page)">writePage</a></strong>(<a href="Page.html" title="interface in simpledb">Page</a>&nbsp;page)</code>
<div class="block">Write a page to disk.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="f">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>f</h4>
<pre>private final&nbsp;java.io.File f</pre>
</li>
</ul>
<a name="td">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>td</h4>
<pre>private final&nbsp;<a href="TupleDesc.html" title="class in simpledb">TupleDesc</a> td</pre>
</li>
</ul>
<a name="tableid">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tableid</h4>
<pre>private final&nbsp;int tableid</pre>
</li>
</ul>
<a name="keyField">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>keyField</h4>
<pre>private&nbsp;int keyField</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BPlusTreeFile(java.io.File, int, simpledb.TupleDesc)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BPlusTreeFile</h4>
<pre>public&nbsp;BPlusTreeFile(java.io.File&nbsp;f,
             int&nbsp;key,
             <a href="TupleDesc.html" title="class in simpledb">TupleDesc</a>&nbsp;td)</pre>
<div class="block">Constructs a B+ tree file backed by the specified file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>f</code> - - the file that stores the on-disk backing store for this B+ tree
            file.</dd><dd><code>key</code> - - the field which index is keyed on</dd><dd><code>td</code> - - the tuple descriptor of tuples in the file</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getFile()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFile</h4>
<pre>public&nbsp;java.io.File&nbsp;getFile()</pre>
<div class="block">Returns the File backing this BPlusTreeFile on disk.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the File backing this BPlusTreeFile on disk.</dd></dl>
</li>
</ul>
<a name="getId()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getId</h4>
<pre>public&nbsp;int&nbsp;getId()</pre>
<div class="block">Returns an ID uniquely identifying this BPlusTreeFile. Implementation note:
 you will need to generate this tableid somewhere ensure that each
 BPlusTreeFile has a "unique id," and that you always return the same value for
 a particular BPlusTreeFile. We suggest hashing the absolute file name of the
 file underlying the BPlusTreeFile, i.e. f.getAbsoluteFile().hashCode().</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#getId()">getId</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>an ID uniquely identifying this BPlusTreeFile.</dd></dl>
</li>
</ul>
<a name="getTupleDesc()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTupleDesc</h4>
<pre>public&nbsp;<a href="TupleDesc.html" title="class in simpledb">TupleDesc</a>&nbsp;getTupleDesc()</pre>
<div class="block">Returns the TupleDesc of the table stored in this DbFile.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#getTupleDesc()">getTupleDesc</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>TupleDesc of this DbFile.</dd></dl>
</li>
</ul>
<a name="readPage(simpledb.PageId)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readPage</h4>
<pre>public&nbsp;<a href="Page.html" title="interface in simpledb">Page</a>&nbsp;readPage(<a href="PageId.html" title="interface in simpledb">PageId</a>&nbsp;pid)</pre>
<div class="block">Read a page from the file on disk. This should not be called directly
 but should be called from the BufferPool via getPage()</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#readPage(simpledb.PageId)">readPage</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>pid</code> - - the id of the page to read from disk</dd></dl>
</li>
</ul>
<a name="writePage(simpledb.Page)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writePage</h4>
<pre>public&nbsp;void&nbsp;writePage(<a href="Page.html" title="interface in simpledb">Page</a>&nbsp;page)
               throws java.io.IOException</pre>
<div class="block">Write a page to disk.  This should not be called directly but should 
 be called from the BufferPool when pages are flushed to disk</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#writePage(simpledb.Page)">writePage</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>page</code> - - the page to write to disk</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if the write fails</dd></dl>
</li>
</ul>
<a name="numPages()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>numPages</h4>
<pre>public&nbsp;int&nbsp;numPages()</pre>
<div class="block">Returns the number of pages in this BPlusTreeFile.</div>
</li>
</ul>
<a name="keyField()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>keyField</h4>
<pre>public&nbsp;int&nbsp;keyField()</pre>
<div class="block">Returns the index of the field that this B+ tree is keyed on</div>
</li>
</ul>
<a name="findLeafPage(simpledb.TransactionId, simpledb.Field, simpledb.BPlusTreePageId, simpledb.Permissions)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findLeafPage</h4>
<pre><a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;findLeafPage(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                             <a href="Field.html" title="interface in simpledb">Field</a>&nbsp;f,
                             <a href="BPlusTreePageId.html" title="class in simpledb">BPlusTreePageId</a>&nbsp;pid,
                             <a href="Permissions.html" title="class in simpledb">Permissions</a>&nbsp;perm)
                         throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Recursive function which finds and locks the leaf page in the B+ tree corresponding to
 the left-most page possibly containing the key field f. It locks all internal
 nodes along the path to the leaf node with READ_ONLY permission, and locks the 
 leaf node with permission perm.
 
 If f is null, it finds the left-most leaf page -- used for the iterator</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>f</code> - - the field to search for</dd><dd><code>pid</code> - - the current page being searched</dd><dd><code>perm</code> - - the permissions with which to lock the leaf page</dd>
<dt><span class="strong">Returns:</span></dt><dd>the left-most leaf page possibly containing the key field f</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="splitLeafPage(simpledb.BPlusTreeLeafPage, simpledb.TransactionId, java.util.HashSet, simpledb.Field)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>splitLeafPage</h4>
<pre>private&nbsp;<a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;splitLeafPage(<a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;page,
                              <a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                              java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages,
                              <a href="Field.html" title="interface in simpledb">Field</a>&nbsp;field)
                                 throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                        java.io.IOException,
                                        <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Split a leaf page to make room for new tuples and recursively split the parent node
 as needed. Update all pointers as needed.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>page</code> - - the leaf page to split</dd><dd><code>tid</code> - - the transaction id</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd><dd><code>field</code> - - the key field of the tuple to be inserted after the split is complete. Necessary to know
 which of the two pages to return.</dd>
<dt><span class="strong">Returns:</span></dt><dd>the leaf page into which the new tuple should be inserted</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="splitInternalPage(simpledb.BPlusTreeInternalPage, simpledb.TransactionId, java.util.HashSet, simpledb.Field)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>splitInternalPage</h4>
<pre>private&nbsp;<a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;splitInternalPage(<a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;page,
                                      <a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                                      java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages,
                                      <a href="Field.html" title="interface in simpledb">Field</a>&nbsp;field)
                                         throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                                java.io.IOException,
                                                <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Recursively split internal pages as needed to make room for new entries. Update
 all pointers as needed.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>page</code> - - the internal page to split</dd><dd><code>tid</code> - - transaction id</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd><dd><code>field</code> - - the key field of the entry to be inserted after the split is complete. Necessary to know
 which of the two pages to return.</dd>
<dt><span class="strong">Returns:</span></dt><dd>the internal page into which the new entry should be inserted</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="updateParentPointer(simpledb.TransactionId, simpledb.BPlusTreePageId, simpledb.BPlusTreePageId, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateParentPointer</h4>
<pre>private&nbsp;void&nbsp;updateParentPointer(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                       <a href="BPlusTreePageId.html" title="class in simpledb">BPlusTreePageId</a>&nbsp;pid,
                       <a href="BPlusTreePageId.html" title="class in simpledb">BPlusTreePageId</a>&nbsp;child,
                       java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                          throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                 java.io.IOException,
                                 <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Helper function to update the parent pointer of a node.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - transaction id</dd><dd><code>pid</code> - - id of the parent node</dd><dd><code>child</code> - - id of the child node to be updated with the parent pointer</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="updateParentPointers(simpledb.TransactionId, simpledb.BPlusTreeInternalPage, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateParentPointers</h4>
<pre>private&nbsp;void&nbsp;updateParentPointers(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                        <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;page,
                        java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                           throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                  java.io.IOException,
                                  <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Update the parent pointer of every child of the given page</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - transaction id</dd><dd><code>page</code> - - the parent page</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="insertTuple(simpledb.TransactionId, simpledb.Tuple)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>insertTuple</h4>
<pre>public&nbsp;java.util.ArrayList&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;insertTuple(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                                    <a href="Tuple.html" title="class in simpledb">Tuple</a>&nbsp;t)
                                      throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                             java.io.IOException,
                                             <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Insert a tuple into this BPlusTreeFile, keeping the tuples in sorted order. 
 May cause pages to split if the page where tuple t belongs is full.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#insertTuple(simpledb.TransactionId, simpledb.Tuple)">insertTuple</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>t</code> - - the tuple to insert</dd>
<dt><span class="strong">Returns:</span></dt><dd>a list of all pages that were dirtied by this operation. Could include
 many pages since parent pointers will need to be updated when an internal node splits.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code> - if the tuple cannot be added</dd>
<dd><code>java.io.IOException</code> - if the needed file can't be read/written</dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="handleMinOccupancyLeafPage(simpledb.TransactionId, simpledb.BPlusTreeLeafPage, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleMinOccupancyLeafPage</h4>
<pre>private&nbsp;void&nbsp;handleMinOccupancyLeafPage(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                              <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;page,
                              java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                                 throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                        java.io.IOException,
                                        <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Handle the case when a leaf page becomes less than half full due to deletions.
 If one of its siblings has extra tuples, redistribute those tuples.
 Otherwise merge with one of the siblings. Update pointers as needed.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>page</code> - - the leaf page which is less than half full</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="handleMinOccupancyInternalPage(simpledb.TransactionId, simpledb.BPlusTreeInternalPage, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleMinOccupancyInternalPage</h4>
<pre>private&nbsp;void&nbsp;handleMinOccupancyInternalPage(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                                  <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;page,
                                  java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                                     throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                            java.io.IOException,
                                            <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Handle the case when an internal page becomes less than half full due to deletions.
 If one of its siblings has extra entries, redistribute those entries.
 Otherwise merge with one of the siblings. Update pointers as needed.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>page</code> - - the internal page which is less than half full</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="mergeLeafPages(simpledb.TransactionId, simpledb.BPlusTreeLeafPage, simpledb.BPlusTreeLeafPage, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeEntry, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mergeLeafPages</h4>
<pre>private&nbsp;void&nbsp;mergeLeafPages(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                  <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;leftPage,
                  <a href="BPlusTreeLeafPage.html" title="class in simpledb">BPlusTreeLeafPage</a>&nbsp;rightPage,
                  <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;parent,
                  <a href="BPlusTreeEntry.html" title="class in simpledb">BPlusTreeEntry</a>&nbsp;parentEntry,
                  java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                     throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                            java.io.IOException,
                            <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Merge two leaf pages by moving all tuples from the right page to the left page. 
 Recursively handle the case when the parent gets below minimum occupancy.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>leftPage</code> - - the left leaf page</dd><dd><code>rightPage</code> - - the right leaf page</dd><dd><code>parent</code> - - the parent of the two pages</dd><dd><code>parentEntry</code> - - the entry in the parent corresponding to the leftPage and rightPage</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="mergeInternalPages(simpledb.TransactionId, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeInternalPage, simpledb.BPlusTreeEntry, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mergeInternalPages</h4>
<pre>private&nbsp;void&nbsp;mergeInternalPages(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                      <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;leftPage,
                      <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;rightPage,
                      <a href="BPlusTreeInternalPage.html" title="class in simpledb">BPlusTreeInternalPage</a>&nbsp;parent,
                      <a href="BPlusTreeEntry.html" title="class in simpledb">BPlusTreeEntry</a>&nbsp;parentEntry,
                      java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                         throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                java.io.IOException,
                                <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Merge two internal pages by moving all entries from the right page to the left page. 
 Recursively handle the case when the parent gets below minimum occupancy.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>leftPage</code> - - the left internal page</dd><dd><code>rightPage</code> - - the right internal page</dd><dd><code>parent</code> - - the parent of the two pages</dd><dd><code>parentEntry</code> - - the entry in the parent corresponding to the leftPage and rightPage</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="deleteTuple(simpledb.TransactionId, simpledb.Tuple)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteTuple</h4>
<pre>public&nbsp;java.util.ArrayList&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;deleteTuple(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                                    <a href="Tuple.html" title="class in simpledb">Tuple</a>&nbsp;t)
                                      throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                             java.io.IOException,
                                             <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Delete a tuple from this BPlusTreeFile. 
 May cause pages to merge or redistribute entries/tuples if the pages 
 become less than half full.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#deleteTuple(simpledb.TransactionId, simpledb.Tuple)">deleteTuple</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>t</code> - - the tuple to delete</dd>
<dt><span class="strong">Returns:</span></dt><dd>a list of all pages that were dirtied by this operation. Could include
 many pages since parent pointers will need to be updated when an internal node merges.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code> - if the tuple cannot be deleted or is not a member
   of the file</dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="getRootPtrPage(simpledb.TransactionId)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRootPtrPage</h4>
<pre>private&nbsp;<a href="BPlusTreeRootPtrPage.html" title="class in simpledb">BPlusTreeRootPtrPage</a>&nbsp;getRootPtrPage(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid)
                                     throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                                            java.io.IOException,
                                            <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Get a read lock on the root pointer page. Create the root pointer page and root page
 if necessary.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - transaction id</dd>
<dt><span class="strong">Returns:</span></dt><dd>the root pointer page</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="getEmptyPage(simpledb.TransactionId, java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEmptyPage</h4>
<pre>private&nbsp;int&nbsp;getEmptyPage(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
               java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages)
                  throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                         java.io.IOException,
                         <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Get the page number of the first empty page in this BPlusTreeFile.
 Creates a new page if none of the existing pages are empty.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - transaction id</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd>
<dt><span class="strong">Returns:</span></dt><dd>the page number of the first empty page</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="setEmptyPage(simpledb.TransactionId, java.util.HashSet, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setEmptyPage</h4>
<pre>private&nbsp;void&nbsp;setEmptyPage(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                java.util.HashSet&lt;<a href="Page.html" title="interface in simpledb">Page</a>&gt;&nbsp;dirtypages,
                int&nbsp;emptyPageNo)
                   throws <a href="DbException.html" title="class in simpledb">DbException</a>,
                          java.io.IOException,
                          <a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></pre>
<div class="block">Mark a page in this BPlusTreeFile as empty. 
 If this is the last page in the file, just truncate the file. Otherwise, 
 find the corresponding header page (create it if needed), and mark
 the corresponding slot in the header page as empty.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - transaction id</dd><dd><code>dirtypages</code> - - the list of dirty pages which should be updated with all new dirty pages</dd><dd><code>emptyPageNo</code> - - the page number of the empty page</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="DbException.html" title="class in simpledb">DbException</a></code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="TransactionAbortedException.html" title="class in simpledb">TransactionAbortedException</a></code></dd></dl>
</li>
</ul>
<a name="indexIterator(simpledb.TransactionId, simpledb.IndexPredicate)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>indexIterator</h4>
<pre>public&nbsp;<a href="DbFileIterator.html" title="interface in simpledb">DbFileIterator</a>&nbsp;indexIterator(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid,
                           <a href="IndexPredicate.html" title="class in simpledb">IndexPredicate</a>&nbsp;ipred)</pre>
<div class="block">get the specified tuples from the file based on its IndexPredicate value on
 behalf of the specified transaction. This method will acquire a read lock on
 the affected pages of the file, and may block until the lock can be
 acquired.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd><dd><code>ipred</code> - - the index predicate value to filter on</dd>
<dt><span class="strong">Returns:</span></dt><dd>an iterator for the filtered tuples</dd></dl>
</li>
</ul>
<a name="iterator(simpledb.TransactionId)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>iterator</h4>
<pre>public&nbsp;<a href="DbFileIterator.html" title="interface in simpledb">DbFileIterator</a>&nbsp;iterator(<a href="TransactionId.html" title="class in simpledb">TransactionId</a>&nbsp;tid)</pre>
<div class="block">Get an iterator for all tuples in this B+ tree file in sorted order. This method 
 will acquire a read lock on the affected pages of the file, and may block until 
 the lock can be acquired.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="DbFile.html#iterator(simpledb.TransactionId)">iterator</a></code>&nbsp;in interface&nbsp;<code><a href="DbFile.html" title="interface in simpledb">DbFile</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>tid</code> - - the transaction id</dd>
<dt><span class="strong">Returns:</span></dt><dd>an iterator for all the tuples in this file</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="BPlusTreeFile.html#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="BPlusTreeEntry.html" title="class in simpledb"><span class="strong">Prev Class</span></a></li>
<li><a href="BPlusTreeFileEncoder.html" title="class in simpledb"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html@simpledb%252FBPlusTreeFile.html" target="_top">Frames</a></li>
<li><a href="BPlusTreeFile.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="BPlusTreeFile.html#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="BPlusTreeFile.html#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>